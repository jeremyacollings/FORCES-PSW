com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym9 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym10 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:invaded
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym11 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no fencing:worm
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
trym12 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no invaded:worm
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
trym13 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:area:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym14 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:invaded:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym15 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no invaded:fencing:worms
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
year <- c(rep(1, times = 162), rep(3, times = 162))
worm.mass <- mydata$worms$ew.mass.mean
worm.count <- mydata$worms$ew.count.mean
psw <- mydata$veg$vinros
plot_type <- as.factor(paste(mydata$identifiers$site,
mydata$identifiers$area,
mydata$identifiers$plot,
sep = ""))
fencing <- ifelse(mydata$identifiers$plot == "F", "F", "O")
invaded <- ifelse(mydata$identifiers$plot == "N", "uninv", "inv")
com.dat <- cbind.data.frame("site" = mydata$identifiers$site, "area" = mydata$identifiers$area,
"plot" = mydata$identifiers$plot, "fencing" = fencing,
"invaded" = invaded, "plot_type" = plot_type,
"year" = year, "worm.mass" = worm.mass, "worm.count" = worm.count,
"psw" = psw, round(mydata$veg_noPSW))
com_bund <- mvabund(com.dat[,11:93]) #
all <- mydata$veg_noPSW
notinvasives <- all[-c(6, 13, 22, 40, 44, 63, 64)]
natives <- notinvasives[-c(6, 15, 23, 25, 30, 33, 36, 37, 43, 51, 55, 58, 64, 65, 70:78)]
com.dat2 <- cbind.data.frame("site" = mydata$identifiers$site, "area" = mydata$identifiers$area,
"plot" = mydata$identifiers$plot, "plot_type" = plot_type,
"fencing" = fencing, "invaded" = invaded,
"year" = year, "worm.mass" = worm.mass, "worm.count" = worm.count,
"psw" = psw, round(notinvasives))
com_bund2 <- mvabund(com.dat2[,11:86])
com.dat3 <- cbind.data.frame("site" = mydata$identifiers$site, "area" = mydata$identifiers$area,
"plot" = mydata$identifiers$plot, "plot_type" = plot_type,
"fencing" = fencing, "invaded" = invaded,
"year" = year, "worm.mass" = worm.mass, "worm.count" = worm.count,
"psw" = psw, round(natives))
com_bund3 <- mvabund(com.dat3[,11:65])
area.fence.
trym0 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # complete model
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym0 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # complete model
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym1 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no worms
com.dat$invaded +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
trym2 <- manyglm(com_bund ~ com.dat$area + com.dat$fencing +   # no year
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym3 <- manyglm(com_bund ~ com.dat$year + com.dat$fencing +   # no area
com.dat$invaded + com.dat$worm.count +
com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym4 <- manyglm(com_bund ~ com.dat$year + com.dat$area +   # no fencing
com.dat$invaded + com.dat$worm.count +
com.dat$year:com.dat$area +
com.dat$year:com.dat$invaded +
com.dat$invaded:com.dat$worm.count)
trym5 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no invaded
com.dat$worm.count +
com.dat$area:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$fencing:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing)
trym6 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no area:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym7 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no invaded:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing)
trym8 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:area
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym9 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym10 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:invaded
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym11 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no fencing:worm
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
trym12 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no invaded:worm
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
trym13 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:area:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$invaded:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym14 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no year:invaded:fencing
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$invaded:com.dat$fencing:com.dat$worm.count)
trym15 <- manyglm(com_bund ~ com.dat$year + com.dat$area + com.dat$fencing +   # no invaded:fencing:worms
com.dat$invaded + com.dat$worm.count +
com.dat$area:com.dat$fencing + com.dat$invaded:com.dat$fencing +
com.dat$year:com.dat$area + com.dat$year:com.dat$fencing +
com.dat$year:com.dat$invaded + com.dat$fencing:com.dat$worm.count +
com.dat$invaded:com.dat$worm.count +
com.dat$year:com.dat$area:com.dat$fencing +
com.dat$year:com.dat$invaded:com.dat$fencing)
### MODEL COMPARISON
# to account for nested data
control <- how(within = Within(type = 'none'),
plots = Plots(strata = com.dat$plot_type, type = 'free'),
nperm = 1000)
permutations <- shuffleSet(nrow(com_bund), control = control)
worms. <- anova(trym0, trym1, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(worms., "Whole Worms.rds")
year. <- anova(trym0, trym2, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(year., ("Whole Year.rds"))
area. <- anova(trym0, trym3, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(area., "Whole Area.rds")
fence. <- anova(trym0, trym4, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(fence., "Whole Fence.rds")
invade. <- anova(trym0, trym5, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(invade., "Whole Invade.rds")
area.fence. <- anova(trym0, trym6, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(area.fence., "Whole Area-Fence.rds")
invade.fence. <- anova(trym0, trym7, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(invade.fence., "Whole Invade-Fence.rds")
year.area. <- anova(trym0, trym8, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(year.area., "Whole Year-Area.rds")
year.fence. <- anova(trym0, trym9, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(year.fence., "Whole Year-Fence.rds")
year.invade. <- anova(trym0, trym10, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(year.invade., "Whole Year-Invade.rds")
fence.worms. <- anova(trym0, trym11, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(fence.worms., "Whole Fence-Worms.rds")
invade.worms. <- anova(trym0, trym12, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(invade.worms., "Whole Invade-Worms.rds")
year.area.fence. <- anova(trym0, trym13, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(year.area.fence., "Whole Year-Area-Fence.rds")
year.invade.fence. <- anova(trym0, trym14, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(year.invade.fence., "Whole Year-Invade-Fence.rds")
invade.fence.worms. <- anova(trym0, trym15, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(invade.fence.worms., "Whole Invade-Fence-Worms.rds")
worms.
year.
area.
fence.
invade.
area.fence.
invade.fence.
year.area.
year.fence.
year.invade.
fence.worms.
invade.worms.
year.invade.fence.
year.invade.fence.
year.area.fence.
invade.fence.worms.
invade.fence.worms.
worms.
year.
area.
fence.
invade.
area.fence.
year.area.
year.invade.
fence.worms
dence.worms.
fence.worms.
invade.worms.
plot(x = com.dat2$worm.count, com.dat2$germac)
plot(x = com.dat2$worm.count, com.dat2$ostvir)
plot(x = com.dat2$year, y = com.dat2$cirlut)
plot(x = com.dat2$year, y = com.dat2$pinstr)
plot(x = com.dat2$year, y = com.dat2$ostvir)
plot(x = com.dat2$area, com.dat2$germac)
boxplot(x = com.dat2$area, y = com.dat2$germac)
boxplot(germac~area, data = com.dat2)
boxplot(myosyl~area, data = com.dat2)
boxplot(parqui~area, data = com.dat2)
boxplot(rosmul~area, data = com.dat2)
boxplot(rosmul~area, data = com.dat2)
boxplot(germac~area, data = com.dat)
boxplot(rosmul~area, data = com.dat)
summary(YPA.F)
load("~/GitHub/FORCES-PSW/Whole YPA Fenced.rds")
load(Whole YPA Fenced.rds)
load("Whole YPA Fenced.rds")
YPA.F <- readRDS("~/GitHub/FORCES-PSW/Whole YPA Fenced.rds")
summary(YPA.F)
YPA.F
YP.F <- readRDS("~/GitHub/FORCES-PSW/Whole YP Fenced.rds")
YA.F <- readRDS("~/GitHub/FORCES-PSW/Whole YA Fenced.rds")
AP.F <- readRDS("~/GitHub/FORCES-PSW/Whole AP Fenced.rds")
AP.I <- readRDS("~/GitHub/FORCES-PSW/Whole AP Invaded.rds")
worms.I <- readRDS("~/GitHub/FORCES-PSW/Whole Worms Invaded.rds")
AP.I <- readRDS("~/GitHub/FORCES-PSW/Whole AP Invaded.rds")
YA.I <- readRDS("~/GitHub/FORCES-PSW/Whole YA Invaded.rds")
YP.I <- readRDS("~/GitHub/FORCES-PSW/Whole YP Invaded.rds")
YPA.I <- readRDS("~/GitHub/FORCES-PSW/Whole YPA Invaded.rds")
year.I <- readRDS("~/GitHub/FORCES-PSW/Whole Year Fenced.rds")
year.F <- readRDS("~/GitHub/FORCES-PSW/Whole Year Fenced.rds")
area.F <- readRDS("~/GitHub/FORCES-PSW/Whole Area Fenced.rds")
plot.F <- readRDS("~/GitHub/FORCES-PSW/Whole Plot Fenced.rds")
worms.F <- readRDS("~/GitHub/FORCES-PSW/Whole Worms Fenced.rds")
AP.F <- readRDS("~/GitHub/FORCES-PSW/Whole AP Fenced.rds")
YA.F <- readRDS("~/GitHub/FORCES-PSW/Whole YA Fenced.rds")
YP.F <- readRDS("~/GitHub/FORCES-PSW/Whole YP Fenced.rds")
YP.F
YA.F
AP.F
worms.F
plot.F
area.F
year.F
YPA.I
YP.I
YA.I
AP.I
worms.I
library(tidyverse)
library(mvabund)
library(patchwork)
year <- c(rep(1, times = 162), rep(3, times = 162))
worm.mass <- mydata$worms$ew.mass.mean
worm.count <- mydata$worms$ew.count.mean
psw <- mydata$veg$vinros
plot_type <- as.factor(paste(mydata$identifiers$site,
mydata$identifiers$area,
mydata$identifiers$plot,
sep = ""))
fencing <- ifelse(mydata$identifiers$plot == "F", "F", "O")
invaded <- ifelse(mydata$identifiers$plot == "N", "uninv", "inv")
com.dat <- cbind.data.frame("site" = mydata$identifiers$site, "area" = mydata$identifiers$area,
"plot" = mydata$identifiers$plot, "fencing" = fencing,
"invaded" = invaded, "plot_type" = plot_type,
"year" = year, "worm.mass" = worm.mass, "worm.count" = worm.count,
"psw" = psw, round(mydata$veg_noPSW))
com.dat.fence <- com.dat[com.dat$invaded == "inv", ]
com.dat.invade <- com.dat[com.dat$fencing == "O", ]
com_bund_fence <- mvabund(com.dat.fence[,11:93]) # transforms community data into mvabund appropriate object
com_bund_invade <- mvabund(com.dat.invade[,11:93])
control.I <- how(within = Within(type = 'none'),
plots = Plots(strata = com.dat.invade$plot_type, type = 'free'),
nperm = 1000)
permutations.I <- shuffleSet(nrow(com_bund_invade), control = control.I)
trym.i0 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # complete model
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area:com.dat.invade$plot)
trym.i1 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no 3way
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot)
trym.i2 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no year:plot
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area)
trym.i3 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no year:area
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$plot)
trym.i4 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no ara:plot
com.dat.invade$worm.count +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot)
trym.i5 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +    # no worms
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area:com.dat.invade$plot)
trym.i6 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area +    # no plot
com.dat.invade$worm.count +
com.dat.invade$year:com.dat.invade$area)
trym.i7 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$plot +   # no area
com.dat.invade$worm.count + com.dat.invade$year:com.dat.invade$plot)
trym.i8 <- manyglm(com_bund_invade ~ com.dat.invade$area + com.dat.invade$plot +   # no year
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot)
plot.I <- anova(trym.i0, trym.i6, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole Plot Invaded.rds")
area.I <- anova(trym.i0, trym.i7, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole Area Invaded.rds")
year.I <- anova(trym.i0, trym.i8, bootID = permutations, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole Year Invaded.rds")
trym.f0 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area + com.dat.fence$plot +   # complete model
com.dat.fence$worm.count +
com.dat.fence$area:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$area + com.dat.fence$year:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$area:com.dat.fence$plot)
trym.f1 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area + com.dat.fence$plot +   # no 3way
com.dat.fence$worm.count +
com.dat.fence$area:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$area + com.dat.fence$year:com.dat.fence$plot)
trym.f2 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area + com.dat.fence$plot +   # no year:plot
com.dat.fence$worm.count +
com.dat.fence$area:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$area)
trym.f3 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area + com.dat.fence$plot +   # no year:area
com.dat.fence$worm.count +
com.dat.fence$area:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$plot)
trym.f4 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area + com.dat.fence$plot +   # no ara:plot
com.dat.fence$worm.count +
com.dat.fence$year:com.dat.fence$area + com.dat.fence$year:com.dat.fence$plot)
trym.f5 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area + com.dat.fence$plot +    # no worms
com.dat.fence$area:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$area + com.dat.fence$year:com.dat.fence$plot +
com.dat.fence$year:com.dat.fence$area:com.dat.fence$plot)
trym.f6 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area +    # no plot
com.dat.fence$worm.count +
com.dat.fence$year:com.dat.fence$area)
trym.f7 <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$plot +   # no area
com.dat.fence$worm.count + com.dat.fence$year:com.dat.fence$plot)
trym.f8 <- manyglm(com_bund_fence ~ com.dat.fence$area + com.dat.fence$plot +   # no year
com.dat.fence$worm.count +
com.dat.fence$area:com.dat.fence$plot)
control.F <- how(within = Within(type = 'none'),
plots = Plots(strata = com.dat.fence$plot_type, type = 'free'),
nperm = 1000)
permutations.F <- shuffleSet(nrow(com_bund_fence), control = control.F)
YPA.F <- anova(trym.f0, trym.f1, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.F, "Whole YPA Fenced.rds")
YP.F <- anova(trym.f0, trym.f2, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(YP.F, "Whole YP Fenced.rds")
YA.F <- anova(trym.f0, trym.f3, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(YA.F, "Whole YA Fenced.rds")
AP.F <- anova(trym.f0, trym.f4, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(AP.F, "Whole AP Fenced.rds")
worms.F <- anova(trym.f0, trym.f5, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(worms.F, "Whole Worms Fenced.rds")
plot.F <- anova(trym.f0, trym.f6, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.F, "Whole Plot Fenced.rds")
area.F <- anova(trym.f0, trym.f7, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.F, "Whole Area Fenced.rds")
year.F <- anova(trym.f0, trym.f8, bootID = permutations.F, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.F, "Whole Year Fenced.rds")
control.I <- how(within = Within(type = 'none'),
plots = Plots(strata = com.dat.invade$plot_type, type = 'free'),
nperm = 1000)
permutations.I <- shuffleSet(nrow(com_bund_invade), control = control.I)
trym.i0 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # complete model
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area:com.dat.invade$plot)
trym.i1 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no 3way
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot)
trym.i2 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no year:plot
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area)
trym.i3 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no year:area
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$plot)
trym.i4 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +   # no ara:plot
com.dat.invade$worm.count +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot)
trym.i5 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area + com.dat.invade$plot +    # no worms
com.dat.invade$area:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area + com.dat.invade$year:com.dat.invade$plot +
com.dat.invade$year:com.dat.invade$area:com.dat.invade$plot)
trym.i6 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$area +    # no plot
com.dat.invade$worm.count +
com.dat.invade$year:com.dat.invade$area)
trym.i7 <- manyglm(com_bund_invade ~ com.dat.invade$year + com.dat.invade$plot +   # no area
com.dat.invade$worm.count + com.dat.invade$year:com.dat.invade$plot)
trym.i8 <- manyglm(com_bund_invade ~ com.dat.invade$area + com.dat.invade$plot +   # no year
com.dat.invade$worm.count +
com.dat.invade$area:com.dat.invade$plot)
YPA.I <- anova(trym.i0, trym.i1, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole YPA Invaded.rds")
YP.I <- anova(trym.i0, trym.i2, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(YP.I, "Whole YP Invaded.rds")
YA.I <- anova(trym.i0, trym.i3, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(YA.I, "Whole YA Invaded.rds")
AP.I <- anova(trym.i0, trym.i4, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(AP.I, "Whole AP Invaded.rds")
worms.I <- anova(trym.i0, trym.i5, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(worms.I, "Whole Worms Invaded.rds")
plot.I <- anova(trym.i0, trym.i6, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole Plot Invaded.rds")
area.I <- anova(trym.i0, trym.i7, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole Area Invaded.rds")
year.I <- anova(trym.i0, trym.i8, bootID = permutations.I, p.uni = 'adjusted', test = 'LR')
saveRDS(YPA.I, "Whole Year Invaded.rds")
m.f.final <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area +
com.dat.fence$plot + com.dat.fence$worm.count +
com.dat.fence$year:com.dat.fence$area)
library(tidyverse)
library(mvabund)
library(patchwork)
library(tidyverse)
library(vegan)
library(patchwork)
m.f.final <- manyglm(com_bund_fence ~ com.dat.fence$year + com.dat.fence$area +
com.dat.fence$plot + com.dat.fence$worm.count +
com.dat.fence$year:com.dat.fence$area)
summary(m.f.final)
m.f.final
