geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.3, 0.7, 0.5)) +
scale_y_continuous(limits = c(-1.8, 0.6), breaks = seq(-1.8, 0.6, 0.6)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = O_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
scale_y_continuous(limits = c(-1.8, 0.6), breaks = seq(-1.8, 0.6, 0.6)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
0.6--0.8
1.4/4
ggplot() + geom_point(data = O_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
scale_y_continuous(limits = c(-0.8, 0.6), breaks = seq(-0.8, 0.6, 0.35)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = O_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.5, 1.7), breaks = seq(-1.5, 1.7, 0.8)) +
scale_y_continuous(limits = c(-1, 1.2), breaks = seq(-1, 1.2, 0.55)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = I_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.1, 0.9), breaks = seq(-1.1, 0.9, 0.5)) +
scale_y_continuous(limits = c(-0.7, 0.9), breaks = seq(-0.7, 1.3, 0.4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = I_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-0.8, 1.2), breaks = seq(-0.8, 1.2, 0.5)) +
scale_y_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 1)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
veg_dat_nat <- veg_dat_noinv[, -c(12, 21, 29, 31, 36, 39, 42, 43, 49, 57, 61, 64, 70, 71, 76:84)]
deleted_rows3 <- which(rowSums(veg_dat_nat[, 7:61]) == 0) # Taking out rows with 0% total cover
veg_dat_nat <- veg_dat_nat[-deleted_rows3,]
m24 <- metaMDS(veg_dat_nat[, 7:61], k = 2, trymax = 100)
m24
plot(m24, type = "t")
view(veg_dat_nat)
m25 <- metaMDS(veg_dat_noinv[-c(107), 7:61], k = 2, trymax = 100)
m25
plot(m25, type = "t")
m25 <- metaMDS(veg_dat_nat[-c(107), 7:61], k = 2, trymax = 100)
m25
plot(m25, type = "t")
m25 <- metaMDS(veg_dat_nat[-c(108), 7:61], k = 2, trymax = 100)
m25
plot(m25, type = "t")
m25 <- metaMDS(veg_dat_nat[-c(108), 7:61], k = 2, trymax = 100)
m25
plot(m25, type = "t")
# all the necessary variables
com.scores <- as.data.frame(scores(m25))
com.scores$year <- veg_dat_nat[-c(108), 5]
com.scores$site <- veg_dat_nat[-c(108), 1]
com.scores$area <- veg_dat_nat[-c(108), 2]
com.scores$plot <- veg_dat_nat[-c(108), 3]
com.scores$site.year <- as.factor(paste(com.scores$site, com.scores$year, sep = ""))
com.scores$area.year <- as.factor(paste(com.scores$area, com.scores$year, sep = ""))
com.scores$plot.year <- as.factor(paste(com.scores$plot, com.scores$year, sep = ""))
com.scores.TG <- com.scores[which(com.scores$site == "TG"), ]
com.scores.BM <- com.scores[which(com.scores$site == "BM"), ]
com.scores.GL <- com.scores[which(com.scores$site == "GL"), ]
NMDS1.site.year.mean <- aggregate(NMDS1 ~ site.year, com.scores, mean) # x coordinate of centroid
NMDS1.site.year.sd <- aggregate(NMDS1 ~ site.year, com.scores, sd) # x error bar
NMDS2.site.year.mean <- aggregate(NMDS2 ~ site.year, com.scores, mean) # y coordinate of centroid
NMDS2.site.year.sd <- aggregate(NMDS2 ~ site.year, com.scores, sd) # y error bar
NMDS.site.year <- cbind.data.frame(NMDS1.site.year.mean, NMDS1.site.year.sd$NMDS1,
NMDS2.site.year.mean$NMDS2, NMDS2.site.year.sd$NMDS2)
NMDS.site.year <- plyr::rename(NMDS.site.year, c("site.year" = "site.year", "NMDS1" = "NMDS1.mean",
"NMDS1.site.year.sd$NMDS1" = "NMDS1.sd",
"NMDS2.site.year.mean$NMDS2" = "NMDS2.mean",
"NMDS2.site.year.sd$NMDS2" = "NMDS2.sd"))
NMDS.site.year$site <- c("BM", "BM", "GL", "GL", "TG", "TG")
NMDS.site.year$year <- c(1, 3, 1, 3, 1, 3)
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 1)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
plot(m25, type = "t")
m26 <- metaMDS(veg_dat_nat[-c(15, 74, 108), 7:61], k = 2, trymax = 100)
m26
plot(m26, type = "t")
m26 <- metaMDS(veg_dat_nat[-c(16, 75, 108), 7:61], k = 2, trymax = 100)
m26
plot(m26, type = "t")
# all the necessary variables
com.scores <- as.data.frame(scores(m25))
com.scores$year <- veg_dat_nat[-c(108), 5]
com.scores$site <- veg_dat_nat[-c(108), 1]
com.scores$area <- veg_dat_nat[-c(108), 2]
com.scores$plot <- veg_dat_nat[-c(108), 3]
com.scores$site.year <- as.factor(paste(com.scores$site, com.scores$year, sep = ""))
com.scores$area.year <- as.factor(paste(com.scores$area, com.scores$year, sep = ""))
com.scores$plot.year <- as.factor(paste(com.scores$plot, com.scores$year, sep = ""))
com.scores.TG <- com.scores[which(com.scores$site == "TG"), ]
com.scores.BM <- com.scores[which(com.scores$site == "BM"), ]
com.scores.GL <- com.scores[which(com.scores$site == "GL"), ]
NMDS1.site.year.mean <- aggregate(NMDS1 ~ site.year, com.scores, mean) # x coordinate of centroid
NMDS1.site.year.sd <- aggregate(NMDS1 ~ site.year, com.scores, sd) # x error bar
NMDS2.site.year.mean <- aggregate(NMDS2 ~ site.year, com.scores, mean) # y coordinate of centroid
NMDS2.site.year.sd <- aggregate(NMDS2 ~ site.year, com.scores, sd) # y error bar
NMDS.site.year <- cbind.data.frame(NMDS1.site.year.mean, NMDS1.site.year.sd$NMDS1,
NMDS2.site.year.mean$NMDS2, NMDS2.site.year.sd$NMDS2)
NMDS.site.year <- plyr::rename(NMDS.site.year, c("site.year" = "site.year", "NMDS1" = "NMDS1.mean",
"NMDS1.site.year.sd$NMDS1" = "NMDS1.sd",
"NMDS2.site.year.mean$NMDS2" = "NMDS2.mean",
"NMDS2.site.year.sd$NMDS2" = "NMDS2.sd"))
NMDS.site.year$site <- c("BM", "BM", "GL", "GL", "TG", "TG")
NMDS.site.year$year <- c(1, 3, 1, 3, 1, 3)
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 1)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.5, 1)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-2, 2)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
invaded_dat <- veg_dat_nat[veg_dat_nat$plot != "N", ]
which(rowSums(invaded_dat[, 7:82]) == 0) # all rows still contain some veg
which(rowSums(invaded_dat[, 7:61]) == 0) # all rows still contain some veg
m27 <- metaMDS(invaded_dat[, 7:61], k = 2, trymax = 100)
m27
plot(m27, type = "t")
view(invaded_dat)
m28 <- metaMDS(invaded_dat[-c(29, 31), 7:61], k = 2, trymax = 100)
m28
plot(m28, type = "t")
m29 <- metaMDS(invaded_dat[-c(29, 31, 52), 7:61], k = 2, trymax = 100)
m29
plot(m29, type = "t")
I_scores <- as.data.frame(scores(m29))
I_scores$year <- invaded_dat[-c(29, 31, 52), 5]
I_scores$plot <- invaded_dat[-c(29, 31, 52), 3]
I_scores$area <- invaded_dat[-c(29, 31, 52), 2]
I_scores$plot.year <- as.factor(paste(I_scores$plot, I_scores$year, sep = ""))
I_scores_managed <- I_scores[I_scores$area == "M", ]
I_NMDS1.plot.year.mean <- aggregate(NMDS1 ~ plot.year, I_scores_managed, mean) # x coordinate of centroid
I_NMDS1.plot.year.sd <- aggregate(NMDS1 ~ plot.year, I_scores_managed, sd) # x error bar
I_NMDS2.plot.year.mean <- aggregate(NMDS2 ~ plot.year, I_scores_managed, mean) # y coordinate of centroid
I_NMDS2.plot.year.sd <- aggregate(NMDS2 ~ plot.year, I_scores_managed, sd) # y error bar
I_NMDS.plot.year <- cbind.data.frame(I_NMDS1.plot.year.mean, I_NMDS1.plot.year.sd$NMDS1,
I_NMDS2.plot.year.mean$NMDS2, I_NMDS2.plot.year.sd$NMDS2)
I_NMDS.plot.year <- plyr::rename(I_NMDS.plot.year, c("plot.year" = "plot.year", "NMDS1" = "NMDS1.mean",
"I_NMDS1.plot.year.sd$NMDS1" = "NMDS1.sd",
"I_NMDS2.plot.year.mean$NMDS2" = "NMDS2.mean",
"I_NMDS2.plot.year.sd$NMDS2" = "NMDS2.sd"))
I_NMDS.plot.year$plot <- c("F", "F", "O", "O")
I_NMDS.plot.year$year <- c(1, 3, 1, 3)
I_scores_managed <- I_scores_managed[-c(39), ]
ggplot() + geom_point(data = I_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-0.8, 1.2), breaks = seq(-0.8, 1.2, 0.5)) +
scale_y_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
view(I_scores_managed)
1.7--2.5
4.2/4
1.1 - -1.3
ggplot() + geom_point(data = I_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-2.5, 1.7), breaks = seq(-2.5, 1.7, 1.05)) +
scale_y_continuous(limits = c(-1.3, 1.1), breaks = seq(-1.3, 1.1, 0.6)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
I_scores_reference <- I_scores[I_scores$area == "R", ]
I_NMDS1.plot.year.mean <- aggregate(NMDS1 ~ plot.year, I_scores_reference, mean) # x coordinate of centroid
I_NMDS1.plot.year.sd <- aggregate(NMDS1 ~ plot.year, I_scores_reference, sd) # x error bar
I_NMDS2.plot.year.mean <- aggregate(NMDS2 ~ plot.year, I_scores_reference, mean) # y coordinate of centroid
I_NMDS2.plot.year.sd <- aggregate(NMDS2 ~ plot.year, I_scores_reference, sd) # y error bar
I_NMDS.plot.year <- cbind.data.frame(I_NMDS1.plot.year.mean, I_NMDS1.plot.year.sd$NMDS1,
I_NMDS2.plot.year.mean$NMDS2, I_NMDS2.plot.year.sd$NMDS2)
I_NMDS.plot.year <- plyr::rename(I_NMDS.plot.year, c("plot.year" = "plot.year", "NMDS1" = "NMDS1.mean",
"I_NMDS1.plot.year.sd$NMDS1" = "NMDS1.sd",
"I_NMDS2.plot.year.mean$NMDS2" = "NMDS2.mean",
"I_NMDS2.plot.year.sd$NMDS2" = "NMDS2.sd"))
I_NMDS.plot.year$plot <- c("F", "F", "O", "O")
I_NMDS.plot.year$year <- c(1, 3, 1, 3)
I_scores_reference <- I_scores_reference[-c(2, 5), ]
ggplot() + geom_point(data = I_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.1, 0.9), breaks = seq(-1.1, 0.9, 0.5)) +
scale_y_continuous(limits = c(-0.7, 0.9), breaks = seq(-0.7, 1.3, 0.4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
I_scores_reference
view(I_scores_reference)
1.6--1.2
2.8/4
1.3--1.4
2.7/4
1--1
ggplot() + geom_point(data = I_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 1.6), breaks = seq(-1.2, 1.6, 0.7)) +
scale_y_continuous(limits = c(-1, 1), breaks = seq(-1, 1, 0.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = I_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
scale_y_continuous(limits = c(-1, 1), breaks = seq(-1, 1, 0.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
open_dat <- veg_dat_nat[veg_dat_nat$plot != "F", ]
which(rowSums(open_dat[, 7:61]) == 0) # all rows still contain some veg
open_dat <- veg_dat_nat[veg_dat_nat$plot != "F", ]
which(rowSums(open_dat[, 7:61]) == 0) # all rows still contain some veg
m30 <- metaMDS(open_dat[, 7:82], k = 2, trymax = 100)
m30
m30 <- metaMDS(open_dat[, 7:61], k = 2, trymax = 100)
m30
plot(m30, type = "t")
view(open_dat)
m31 <- metaMDS(open_dat[-c(7), 7:61], k = 2, trymax = 100)
m31
plot(m31, type = "t")
m32 <- metaMDS(open_dat[-c(7, 198), 7:61], k = 2, trymax = 100)
m32
plot(m32, type = "t")
m32 <- metaMDS(open_dat[-c(7, 199), 7:61], k = 2, trymax = 100)
m32
plot(m32, type = "t")
m32 <- metaMDS(open_dat[-c(7, 197), 7:61], k = 2, trymax = 100)
m32
plot(m32, type = "t")
m32 <- metaMDS(open_dat[-c(7, 69), 7:61], k = 2, trymax = 100)
m32
plot(m32, type = "t")
m32 <- metaMDS(open_dat[-c(7, 70), 7:61], k = 2, trymax = 100)
m32
plot(m32, type = "t")
m33 <- metaMDS(open_dat[-c(5, 7, 8, 20, 70), 7:61], k = 2, trymax = 100)
m33
plot(m33, type = "t")
O_scores <- as.data.frame(scores(m33))
O_scores$year <- open_dat[-c(8, 9, 21, 166), 5]
O_scores$area <- open_dat[-c(8, 9, 21, 166), 2]
O_scores$plot <- open_dat[-c(8, 9, 21, 166), 3]
O_scores$plot.year <- as.factor(paste(O_scores$plot, O_scores$year, sep = ""))
O_scores_managed <- O_scores[O_scores$area == "M", ]
O_NMDS1.plot.year.mean <- aggregate(NMDS1 ~ plot.year, O_scores_managed, mean) # x coordinate of centroid
O_NMDS1.plot.year.sd <- aggregate(NMDS1 ~ plot.year, O_scores_managed, sd) # x error bar
O_NMDS2.plot.year.mean <- aggregate(NMDS2 ~ plot.year, O_scores_managed, mean) # y coordinate of centroid
O_NMDS2.plot.year.sd <- aggregate(NMDS2 ~ plot.year, O_scores_managed, sd) # y error bar
O_NMDS.plot.year <- cbind.data.frame(O_NMDS1.plot.year.mean, O_NMDS1.plot.year.sd$NMDS1,
O_NMDS2.plot.year.mean$NMDS2, O_NMDS2.plot.year.sd$NMDS2)
O_NMDS.plot.year <- plyr::rename(O_NMDS.plot.year, c("plot.year" = "plot.year", "NMDS1" = "NMDS1.mean",
"O_NMDS1.plot.year.sd$NMDS1" = "NMDS1.sd",
"O_NMDS2.plot.year.mean$NMDS2" = "NMDS2.mean",
"O_NMDS2.plot.year.sd$NMDS2" = "NMDS2.sd"))
O_NMDS.plot.year$plot <- c("N", "N", "O", "O")
O_NMDS.plot.year$year <- c(1, 3, 1, 3)
O_scores_managed$plot[O_scores_managed$plot == "O"] <- "O"
O_scores_managed <- O_scores_managed[-c(39), ]
ggplot() + geom_point(data = O_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.5, 1.7), breaks = seq(-1.5, 1.7, 0.8)) +
scale_y_continuous(limits = c(-1, 1.2), breaks = seq(-1, 1.2, 0.55)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
O_scores <- as.data.frame(scores(m33))
O_scores$year <- open_dat[-c(8, 9, 21, 166), 5]
O_scores <- as.data.frame(scores(m33))
O_scores$year <- open_dat[-c(8, 9, 21, 166), 5]
O_scores <- as.data.frame(scores(m33))
O_scores$year <- open_dat[-c(5, 7, 8, 20, 70), 5]
O_scores$area <- open_dat[-c(5, 7, 8, 20, 70), 2]
O_scores$plot <- open_dat[-c(5, 7, 8, 20, 70), 3]
O_scores$plot.year <- as.factor(paste(O_scores$plot, O_scores$year, sep = ""))
O_scores_managed <- O_scores[O_scores$area == "M", ]
O_NMDS1.plot.year.mean <- aggregate(NMDS1 ~ plot.year, O_scores_managed, mean) # x coordinate of centroid
O_NMDS1.plot.year.sd <- aggregate(NMDS1 ~ plot.year, O_scores_managed, sd) # x error bar
O_NMDS2.plot.year.mean <- aggregate(NMDS2 ~ plot.year, O_scores_managed, mean) # y coordinate of centroid
O_NMDS2.plot.year.sd <- aggregate(NMDS2 ~ plot.year, O_scores_managed, sd) # y error bar
O_NMDS.plot.year <- cbind.data.frame(O_NMDS1.plot.year.mean, O_NMDS1.plot.year.sd$NMDS1,
O_NMDS2.plot.year.mean$NMDS2, O_NMDS2.plot.year.sd$NMDS2)
O_NMDS.plot.year <- plyr::rename(O_NMDS.plot.year, c("plot.year" = "plot.year", "NMDS1" = "NMDS1.mean",
"O_NMDS1.plot.year.sd$NMDS1" = "NMDS1.sd",
"O_NMDS2.plot.year.mean$NMDS2" = "NMDS2.mean",
"O_NMDS2.plot.year.sd$NMDS2" = "NMDS2.sd"))
O_NMDS.plot.year$plot <- c("N", "N", "O", "O")
O_NMDS.plot.year$year <- c(1, 3, 1, 3)
O_scores_managed$plot[O_scores_managed$plot == "O"] <- "O"
O_scores_managed <- O_scores_managed[-c(39), ]
ggplot() + geom_point(data = O_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.5, 1.7), breaks = seq(-1.5, 1.7, 0.8)) +
scale_y_continuous(limits = c(-1, 1.2), breaks = seq(-1, 1.2, 0.55)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
view(O_scores_managed)
2.2--1
3.2/4
ggplot() + geom_point(data = O_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 2.2), breaks = seq(-1, 2.2, 0.8)) +
scale_y_continuous(limits = c(-1, 1.2), breaks = seq(-1, 1.2, 0.55)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = O_scores_managed, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 2.2), breaks = seq(-1, 2.2, 0.8)) +
scale_y_continuous(limits = c(-1, 1), breaks = seq(-1, 1, 0.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
O_scores_reference <- O_scores[O_scores$area == "R", ]
O_NMDS1.plot.year.mean <- aggregate(NMDS1 ~ plot.year, O_scores_reference, mean) # x coordinate of centroid
O_NMDS1.plot.year.sd <- aggregate(NMDS1 ~ plot.year, O_scores_reference, sd) # x error bar
O_NMDS2.plot.year.mean <- aggregate(NMDS2 ~ plot.year, O_scores_reference, mean) # y coordinate of centroid
O_NMDS2.plot.year.sd <- aggregate(NMDS2 ~ plot.year, O_scores_reference, sd) # y error bar
O_NMDS.plot.year <- cbind.data.frame(O_NMDS1.plot.year.mean, O_NMDS1.plot.year.sd$NMDS1,
O_NMDS2.plot.year.mean$NMDS2, O_NMDS2.plot.year.sd$NMDS2)
O_NMDS.plot.year <- plyr::rename(O_NMDS.plot.year, c("plot.year" = "plot.year", "NMDS1" = "NMDS1.mean",
"O_NMDS1.plot.year.sd$NMDS1" = "NMDS1.sd",
"O_NMDS2.plot.year.mean$NMDS2" = "NMDS2.mean",
"O_NMDS2.plot.year.sd$NMDS2" = "NMDS2.sd"))
O_NMDS.plot.year$plot <- c("N", "N", "O", "O")
O_NMDS.plot.year$year <- c(1, 3, 1, 3)
O_scores_reference$plot[O_scores_reference$plot == "O"] <- "O"
O_scores_reference <- O_scores_reference[-c(2, 5), ]
ggplot() + geom_point(data = O_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
scale_y_continuous(limits = c(-0.8, 0.6), breaks = seq(-0.8, 0.6, 0.35)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
O_scores_reference
view(O_scores_reference)
0.8--1
1.8/4
1--0.8
ggplot() + geom_point(data = O_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = O_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("N" = "royalblue4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 0.8), breaks = seq(-1, 0.8, 0.45)) +
scale_y_continuous(limits = c(-0.8, 1), breaks = seq(-0.8, 1, 0.45)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = I_scores_reference, aes(x = NMDS1, y = NMDS2, color = plot, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = plot, shape = as.factor(year)), size = 4) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = plot)) +
geom_errorbar(data = I_NMDS.plot.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = plot)) +
scale_color_manual(name = "Plot", values = c("F" = "green4", "O" = "goldenrod")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1.2, 0.8), breaks = seq(-1.2, 0.8, 0.5)) +
scale_y_continuous(limits = c(-1, 1), breaks = seq(-1, 1, 0.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 1)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
# all the necessary variables
com.scores <- as.data.frame(scores(m15))
com.scores$year <- veg_dat_noinv[-c(17, 76, 101), 5]
com.scores$site <- veg_dat_noinv[-c(17, 76, 101), 1]
com.scores$area <- veg_dat_noinv[-c(17, 76, 101), 2]
com.scores$plot <- veg_dat_noinv[-c(17, 76, 101), 3]
com.scores$site.year <- as.factor(paste(com.scores$site, com.scores$year, sep = ""))
com.scores$area.year <- as.factor(paste(com.scores$area, com.scores$year, sep = ""))
com.scores$plot.year <- as.factor(paste(com.scores$plot, com.scores$year, sep = ""))
com.scores.TG <- com.scores[which(com.scores$site == "TG"), ]
com.scores.BM <- com.scores[which(com.scores$site == "BM"), ]
com.scores.GL <- com.scores[which(com.scores$site == "GL"), ]
NMDS1.site.year.mean <- aggregate(NMDS1 ~ site.year, com.scores, mean) # x coordinate of centroid
NMDS1.site.year.sd <- aggregate(NMDS1 ~ site.year, com.scores, sd) # x error bar
NMDS2.site.year.mean <- aggregate(NMDS2 ~ site.year, com.scores, mean) # y coordinate of centroid
NMDS2.site.year.sd <- aggregate(NMDS2 ~ site.year, com.scores, sd) # y error bar
NMDS.site.year <- cbind.data.frame(NMDS1.site.year.mean, NMDS1.site.year.sd$NMDS1,
NMDS2.site.year.mean$NMDS2, NMDS2.site.year.sd$NMDS2)
NMDS.site.year <- plyr::rename(NMDS.site.year, c("site.year" = "site.year", "NMDS1" = "NMDS1.mean",
"NMDS1.site.year.sd$NMDS1" = "NMDS1.sd",
"NMDS2.site.year.mean$NMDS2" = "NMDS2.mean",
"NMDS2.site.year.sd$NMDS2" = "NMDS2.sd"))
NMDS.site.year$site <- c("BM", "BM", "GL", "GL", "TG", "TG")
NMDS.site.year$year <- c(1, 3, 1, 3, 1, 3)
ggplot() + geom_point(data = com.scores, aes(x = NMDS1, y = NMDS2, color = site, shape = as.factor(year)), alpha = 0.5) +
geom_point(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, color = site, shape = as.factor(year)), size = 4) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, xmin = NMDS1.mean - NMDS1.sd, xmax = NMDS1.mean + NMDS1.sd, width = 0, color = site)) +
geom_errorbar(data = NMDS.site.year, aes(x = NMDS1.mean, y = NMDS2.mean, ymin = NMDS2.mean - NMDS2.sd, ymax = NMDS2.mean + NMDS2.sd, width = 0, color = site)) +
scale_color_manual(name = "Site", values = c("BM" = "royalblue4", "GL" = "goldenrod", "TG" = "green4")) +
scale_shape_manual(name = "Year", values = c("1" = 15, "3" = 17)) +
theme_classic(base_size = 12) +
scale_x_continuous(limits = c(-1, 1)) +
scale_y_continuous(limits = c(-1, 1)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1))
invaded_dat <- veg_dat_noinv[veg_dat_noinv$plot != "N", ]
m15
m19
m23
m26
m28
m29
m33
